{% extends "tcms_master.html" %}
{% load report_tags %}

{% block subtitle %}Builds Report - {{ product }}{% endblock %}

{% block custom_javascript %}
{#<script type="text/javascript" src="{{ STATIC_URL }}js/lib/jquery.dataTables.js"></script>#}
<script type="text/javascript" src="{{ STATIC_URL }}js/report.js"></script>
<script type="text/javascript">
Nitrate.Utils.after_page_load(Nitrate.Report.Builds.on_load);
</script>
{% endblock %}

{% block page_content %}
	<nav aria-label="breadcrumb">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a href="{% url "nitrate-index" %}">Home</a></li>
			<li class="breadcrumb-item"><a href="{% url "report-overall" %}">Reporting</a></li>
			<li class="breadcrumb-item active" aria-current="page">Product - {{ product }}</li>
		</ol>
	</nav>
	<div class="container">
		<div class="row">
			<div>
				{% include 'report/nav.html' %}
				{% if build %}
					<div class="report">
						<h2 class="pt-3">Build: {{ build }}</h2>
						{% include "report/case_runs_status_subtotal.html" %}
					</div>
				{% endif %}
				<table class="table table-striped table-bordered" style="margin-top: 15px">
					<thead>
					<tr>
						<th>BUILD</th>
						<th>RUNS (Finished/ Total)</th>
						<th>Case Runs Progress</th>
						<th>Failed Case Runs</th>
					</tr>
					</thead>
					<tbody>
					{% for build in builds %}
						<tr>
							<td>
								<a href="?build_id={{ build.build_id }}">{{ build }}</a>
							</td>
							<td>
								<p>{{ build.finished_runs }}/{{ build.total_runs }}</p>
							</td>
							<td>
								<div class="progress">
									<div class="progress-bar" role="progressbar" style="width: {{ build.finished_case_run_percent|default:'0' }}%"
										aria-valuenow="{{ build.finished_case_run_percent|default:'0' }}" aria-valuemin="0" aria-valuemax="100">
										<span class="pl-1">{{ build.finished_case_run_percent|default:'0' }}%</span>
									</div>
								</div>
							</td>
							<td>
								{% if build.failed_case_run_count %}
									<span class="label label-danger">{{ build.failed_case_run_count|default:'0' }} Failed</span>
								{% endif %}
							</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
{% endblock %}
