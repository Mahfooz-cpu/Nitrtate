{% extends "report/testing-report/master.html" %}

{% block testing_reoprt_breadcrumb %}
<nav aria-label="breadcrumb">
	<ol class="breadcrumb">
		<li class="breadcrumb-item"><a href="{% url "nitrate-index" %}">Home</a></li>
		<li class="breadcrumb-item"><a href="{% url "testing-report" %}">Testing Report</a></li>
		<li class="breadcrumb-item active" aria-current="page">By Plan &amp; Build</li>
	</ol>
</nav>
{% endblock %}

{% block report_content %}
{% if report_data %}
	{% if queries %}
	<ul class="list-group list-group-horizontal">
	{% for k, v in queries.items %}
		<li class="list-group-item border-0 pl-2 pr-2">
			<strong>{{ k|title }}</strong>: {{ v|safe }};
		</li>
	{% endfor %}
	</ul>
	{% endif %}

	<ul class="list-group list-group-horizontal justify-content-end">
		<li class="list-group-item mr-auto border-0 pl-2">
			<a href="{% url "testing-report" %}{{ request_path }}&report_type=per_plan_build_report">Per Plan View</a>
		</li>
		<li class="list-group-item border-0 pl-2 pr-2">
			Plan: <span class="red">{{ report_data.plans_count }}</span>
		</li>
		<li class="list-group-item border-0 pl-2 pr-2">
			Run: <span class="red">{{ report_data.runs_count }}</span>
		</li>
	</ul>

	<table class="table table-striped">
		<thead>
			<tr>
				<th width="68%">Plan</th>
				<th width="8%">Build</th>
				<th width="8%">Run</th>
				<th width="8%">Run Passed</th>
				<th width="8%">Run Failed</th>
			</tr>
		</thead>
		<tbody>
			{% for plan, builds_count, runs_count, status_subtotal in report_data.reports %}
			<tr>
				<td><a href="{{ plan.get_absolute_url }}">{{ plan.name }}</a></td>
				<td>{{ builds_count }}</td>
				<td>{{ runs_count }}</td>
				<td>{{ status_subtotal.PASSED|default:0 }}</td>
				<td>{{ status_subtotal.FAILED|default:0 }}</td>
			</tr>
			{% empty %}
			<tr>
				<td colspan="5" align="center">No report data.</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
{% endif %}
{% endblock %}
