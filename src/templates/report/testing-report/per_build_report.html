{% extends "report/testing-report/master.html" %}

{% block testing_reoprt_breadcrumb %}
<nav aria-label="breadcrumb">
	<ol class="breadcrumb">
		<li class="breadcrumb-item"><a href="{% url "nitrate-index" %}">Home</a></li>
		<li class="breadcrumb-item"><a href="{% url "testing-report" %}">Testing Report</a></li>
		<li class="breadcrumb-item active" aria-current="page">By Case Run Tester</li>
	</ol>
</nav>
{% endblock %}

{% block report_content %}
{% if report_data %}
	{% if queries %}
	<ul class="testing-report-selected-options">
		{% for k, v in queries.items %}
        <li>
			<strong>{{ k|title }}</strong>: {{ v|safe }};
		</li>
		{% endfor %}
		{% if not report_data.builds_selected %}
        <li>
			<strong>Builds:</strong>
			{% for b in report_data.builds %}{{ b }}, {% endfor %}
		</li>
		{% endif %}
	</ul>
	{% endif %}

	<ul class="report-top-stats">
		<li>
			Tester: <strong>All Testers</strong>
		</li>
		<li>
			Plan: <span class="red">{{ report_data.plans_count }}</span>
		</li>
		<li>
			Run: <span class="red">{{ report_data.runs_count }}</span>
		</li>
		<li>
			Case Run: <span class="red">{{ report_data.caseruns_count }}</span>
		</li>
	</ul>

	{% spaceless %}
	<table class="table table-striped table-bordered">
		<thead>
			<tr>
				{% if report_data.builds_selected %}<th width="20%">Build</th>{% endif %}
				<th width="20%">Tested By</th>
				<th>Run Tested</th>
				<th>Case-Run Tested</th>
				<th>Idle</th>
				<th>Running</th>
				<th>Paused</th>
				<th>Passed</th>
				<th>Failed</th>
				<th>Blocked</th>
				<th>Error</th>
				<th>Waived</th>
			</tr>
		</thead>
		<tbody>
		{% if report_data.builds_selected %}
			{% for build, tested_by, runs_count, status_subtotal in report_data.reports %}
			<tr>
					{% ifnotequal build.1 None %}
					<td rowspan="{{ build.1 }}" class="bgRowspan"><span>{{ build.0 }}</span></td>
					{% endifnotequal %}
					<td><span>{{ tested_by }}</span></td>
					<td><span>{{ runs_count }}</span></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}">{{ status_subtotal.total }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=idle">{{ status_subtotal.IDLE|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=running">{{ status_subtotal.RUNNING|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=paused">{{ status_subtotal.PAUSED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=passed">{{ status_subtotal.PASSED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=failed">{{ status_subtotal.FAILED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=blocked">{{ status_subtotal.BLOCKED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=error">{{ status_subtotal.ERROR|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ path_without_build }}&r_build={{ build.0.pk }}&tester={{ tested_by.pk|default:0 }}&status=waived">{{ status_subtotal.WAIVED|default:0 }}</a></td>
			</tr>
			{% empty %}
			<tr><td colspan="11" align="center">No report data.</td></tr>
			{% endfor %}
		{% else %}
			{% for tested_by, runs_count, status_subtotal in report_data.reports %}
			<tr>
					<td><span>{{ tested_by }}</span></td>
					<td><span>{{ runs_count }}</span></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}">{{ status_subtotal.total }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=idle">{{ status_subtotal.IDLE|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=running">{{ status_subtotal.RUNNING|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=paused">{{ status_subtotal.PAUSED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=passed">{{ status_subtotal.PASSED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=failed">{{ status_subtotal.FAILED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=blocked">{{ status_subtotal.BLOCKED|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=error">{{ status_subtotal.ERROR|default:0 }}</a></td>
					<td><a href="{{ report_url }}{{ request_path }}&tester={{ tested_by.pk|default:0 }}&status=waived">{{ status_subtotal.WAIVED|default:0 }}</a></td>
			</tr>
			{% empty %}
			<tr><td colspan="11" align="center">No report data.</td></tr>
			{% endfor %}
		{% endif %}
		</tbody>
	</table>
	{% endspaceless %}
{% endif %} {# end of report data adjudgement #}
{% endblock %}
